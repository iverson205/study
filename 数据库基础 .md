---
title: 数据库基础
tags: Java,SQL,数据库
grammar_cjkRuby: true
---
 # 1.用Java操作数据库
 在使用Java进行数据库开发的最初阶段，都是使用JDBC类来操作数据库的。该方法主要分为以下几个步骤：
### 1.1 定义查询或更新的SQL语句
### 1.2 加载数据库驱动
*   在连接数据库之前，首先要加载想要连接的数据库的驱动到JVM;
*  Class.forName("com.mysql.jdbc.Driver");
### 1.3  获取数据库连接
* 连接所用的URL的定义包括协议（jdbc）、子协议（mysql）、数据源标识；
* 向java.sql.DriverManager请求并获得Connection对象
````markdown
```java
String URL="jdbc.mysql.localhost:3306/lhdb?useUnicode=true&characterEncoding=gbk ; "//数据库名lhdb
String username="root";
String password="root";
try{
Connection conn=DriverManager.getConnection(URL,username,password);
}
catch(Exception e){
}
````
### 1.4创建申明对象
要执行SQL语句，必须获得java.sql.Statement实例，Statement实例分为以下3  
     种类型：   
      1、执行静态SQL语句。通常通过Statement实例实现。   
      2、执行动态SQL语句。通常通过PreparedStatement实例实现。   
      3、执行数据库存储过程。通常通过CallableStatement实例实现。
 ````markdown
 ```java
   Statement stmt = con.createStatement() ;   
   PreparedStatement pstmt = con.prepareStatement(sql) ;   
   CallableStatement cstmt =  con.prepareCall("{CALL demoSp(? , ?)}") ;   
  ````
### 1.5 执行SQL语句
   Statement接口提供了三种执行SQL语句的方法：
   * executeQuery(String sqlString)
    执行查询数据库的SQL语句   ，返回一个结果集（ResultSet）对象。  
    * executeUpdate(String sqlString)
    用于执行INSERT、UPDATE或 DELETE语句以及SQL DDL语句，如：CREATE TABLE和DROP TABLE等   
  * execute(sqlString)
  用于执行返回多个结果集、多个更新计数或二者组合的语句。
  ````markdown
  ```java
  ResultSet rs=stmt.excuteQuery(sql);
  int rows = stmt.executeUpdate("INSERT INTO ...") ;   
  boolean flag = stmt.execute(String sql) ;  
  ```
  ````
  ### 1.6 处理结果 
   * 执行更新返回更改的记录数
   * 执行查询返回的结果集
   ````markdown
   ```java
   while(rs.next())
   {
   		String name=rs.getString("name");
        String pd=rs.getString(1);//列号从1开始，较高效
   }
   ````
### 1.7 关闭结果集、申明对象和数据库连接
# 2.常用SQL语句
按照功能划分，可以分为数据定义语言（DDL）、数据查询语言（DQL）、数据操纵语言（DML）、数据控制语言（DCL）。用的最多的就是增、删、改、查。
* select
select [all|distinct] <目标表达式>[,<目标表达式>]……
from <表或视图>[,表或视图]……
[where <条件表达式>]
[group by <列名1>[having <条件表达式>]]
[order by <列名2>[desc|asc]]
* update
update 表名称 set 列名称=新值 where 列名称=某值
* insert
insert [into] tablename values(值1，值2，……)//插入全部值
insert [into] tablename(列1，列2，……）values(值1，值2，……）//插入部分值
* delete
delete from tables//删除所有行
delete from tablename where nane=‘张三’ //删除指定行
* 其他常用
show databases;//显示数据库名
use database；//切换到某个数据库
show tables;//显示该数据库下全部表名
create table 表名（
列名称1  数据类型，
列名称2  数据类型，
……
）//创建表
 # 3.数据类型
 在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。
 * 文本
 1. char(size)/varchar(size):定长/可变定长
 2. tinytext/text/mediumtext/longtext:255(2^8^)/65535(2^16^)/……
 * 数字
1) tinyint(size)/smallint(size)/mediumint(size)/int(size)/bigint(size):分有符号和无符号两种取值范围
2) float/double（size,d）:在 d 参数中规定小数点右侧的最大位数
 * 日期
 date/datetime/timestamp/time/year
 # 4.应用
 [单表去重](https://leetcode.com/problems/delete-duplicate-emails/)
  [第n名](https://leetcode.com/problems/nth-highest-salary/)
  [多表联查](https://leetcode.com/problems/department-highest-salary/)

